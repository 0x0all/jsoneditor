<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Develop JSONEditor</title>

  <!-- For IE and Edge -->
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.1/es6-shim.min.js"></script>-->

  <script src="../dist/jsoneditor.js"></script>

  <script src="./resources/largeJson.js"></script>

  <style>
    #container {
      height: 500px;
      width: 100%;
      max-width : 800px;
    }
  </style>
</head>
<body>
<p>
  <button id="setJSON">Set JSON</button>
  <button id="getJSON">Get JSON</button>

  <label for="mode">mode:
    <select id="mode">
      <option value="text">text</option>
      <option value="code">code</option>
      <option value="tree" selected>tree</option>
      <option value="form">form</option>
      <option value="view">view</option>
    </select>
  </label>
</p>
<div id="container"></div>

<script>
  // create the editor
  const mode = document.getElementById('mode').value
  const container = document.getElementById('container')
  const options = {
    name: 'myObject',
    onChange: function (patch, revert) {
      console.log('onChange patch=', patch, ', revert=', revert)
      window.patch = patch
      window.revert = revert
    },
    onChangeText: function () {
      console.log('onChangeText')
    },
    onChangeMode: function (mode, prevMode) {
      console.log('switched mode from', prevMode, 'to', mode)
      document.getElementById('mode').value = mode
    },
    onError: function (err) {
      console.error(err)
      alert(err)
    },
    mode: mode,
    modes: ['text', 'code', 'tree', 'form', 'view'],
    indentation: 4,
    escapeUnicode: true,
    history: true
  }
  const editor = jsoneditor(container, options)
  const json = {
    'array': [1, 2, 3],
    'emptyArray': [],
    'emptyObject': {},
    'boolean': true,
    'null': null,
    'number': 123,
    'object': {'a': 'b', 'c': 'd', 'e': [{"first": true}, {"second": true}]},
    'string': 'Hello World',
    'unicode': 'A unicode character: \u260E',
    'url': 'http://jsoneditoronline.org'
  }
  editor.set(json, {
    expand: function (path) {
      return true
    }
  })

  // set json
  document.getElementById('setJSON').onclick = function () {
    editor.set(largeJson, {
      expand: function (path) {
        return true
      }
    })
  }

  // get json
  document.getElementById('getJSON').onclick = function () {
    const json = editor.get()
    alert(JSON.stringify(json, null, 2))
  }

  // change mode
  document.getElementById('mode').onchange = function (event) {
    const mode = event.target.value
    editor.setMode(mode)
  }


</script>
</body>
</html>
